# 项目规范

> 本项目采用DDD

## 什么是DDD(他有什么)

DDD（Domain-Driven Design，领域驱动设计）是一种软件设计方法论，将复杂业务领域的问题归结为领域模型，在保持业务逻辑清晰和可扩展性的同时实现高效开发。

DDD中常用的四层架构分别是：

1. 表现层（Presentation Layer）：是系统的用户界面，包括Web页面、APP、客户端等各种展示层。表现层负责与外界交互，并将请求传导到下一层进行处理。

2. 应用层（Application Layer）：负责实现业务逻辑，协调领域层和基础设施层，并提供与表现层交互的接口。应用层通常包括各种应用服务，例如创建订单、提交购物车等。

3. 领域层（Domain Layer）：领域层包含了业务领域概念和语言的实体、值对象和服务等元素，并实现了领域规则和行为。领域层是整个系统最核心的部分，业务逻辑和规则都在这一层中实现。

4. 基础设施层（Infrastructure Layer）：提供基础设施支持，包括数据库、缓存、消息队列、文件系统等技术实现。基础设施层是整个系统的最底层，与具体技术实现相关，然后为上面的层提供支持。

> 这样分层可以使代码结构更加清晰，职责更加明确，方便维护和扩展。每个层级都有明确的职责和目标，避免了代码的混乱和耦合，同时使得开发人员更加专注于业务本身，提高开发效率。

## 四层调用关系

1. 表现层调用应用层 - 表现层通过HTTP API或其他方式，将请求传递给应用层进行处理，应用层根据业务逻辑和领域层提供的服务，生成合适的响应。表现层只关心请求和响应的格式，而不关心具体的业务逻辑和实现。

2. 应用层调用领域层 - 应用层通过调用领域层提供的领域服务实现业务逻辑。领域服务封装了领域对象的行为，提供了通用的、可复用的方式来实现领域规则和业务逻辑。

3. 领域层调用基础设施层 - 领域层通过基础设施层提供的接口来实现技术实现。例如，领域层通过基础设施层提供的接口向数据库中进行数据访问，进行缓存、消息队列和邮件等相关操作。

4. 基础设施层和其他第三方框架/服务交互 - 基础设施层需要使用第三方框架和服务，例如数据库、缓存、消息队列、邮件等，用于实现系统的基础设施支持。这些框架和服务通常是与技术相关的，而不是与业务逻辑相关的。

> 总之，四个层次之间通过接口进行交互，每一层次都专注于自己的任务和职责，便于代码的分工协作，同时也提高了系统的可维护性和可扩展性。

当结合SpringCloud使用DDD时，可以借鉴以下代码规范：

# 分层

## 领域层

1. 领域对象应该是不可变对象，使用`final`和`private`修饰成员变量。

2. 领域对象应该至少具有一个唯一标识符（ID）。

3. 领域对象应该具有能够描述自身属性的行为和方式。

4. 领域对象应该具有执行规则和业务逻辑的能力。

5. 领域服务应该是可以被重用的，而不是应用程序的唯一实例。

6. 在编写领域对象时，应该尽量减少或者避免对其他领域对象状态的依赖。

7. 定义领域对象时，应该通常以业务流程为导向。

## 基础设施层

1. 基础设施层负责将领域模型保存到数据库或其他数据存储介质中。

2. 在设计数据库和表结构时，应该考虑如何最优地存储领域对象。

3. 在基础设施层中，应该将数据存储的细节封装起来，使之对领域对象透明。

4. 基础设施层应该提供多种不同的数据访问方式，例如：ORM、JDBC等。

## 应用层

1. 应用程序的业务逻辑应该尽可能少地涉及数据存储的细节。

2. 应用层应该将不同领域模型之间的关系进行协调和组织，最终实现具体的应用服务。

3. 应用层应该负责接收和响应用户请求，同时进行请求参数的校验、转换和过滤。

4. 应用层应该负责将领域模型的响应结果转换成适合前端展示的格式进行响应。

5. 在应用层中，应该尽量避免业务逻辑的重复，遵循单一职责原则，提高逻辑复用性。

6. 在编写应用层代码时，应该尽可能使用函数式编程，提高代码的可读性和维护性。

## 表示层（或者接口层）

1. 表示层或接口层负责定义HTTP接口和WebSocket接口等，并对其进行封装。

2. 在定义接口时，应该尽可能使用统一而简洁的方式进行定义，避免使用过多的语言特定的格式和单词。

3. 在响应用户请求时，应该尽可能对出错情况进行检测和处理，保证系统的可用性和稳定性。

4. 进行HTTP接口定义时，应该使用POST、GET、DELETE、PUT等RESTful风格。

此外，建议采用Spring框架配合DDD来进行应用开发。 采用Spring Boot和Spring
Cloud提供的工具和框架来实现微服务的开发和管理。在实践中，可以根据实际业务情况进行具体的优化和调整，从而更适合于实际的项目开发。
